<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8" />
<title>Bildergalerie mit Like & Teilen Animation</title>

<style>
    body {
        font-family: Arial, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        flex-direction: column;
        height: 100vh;
        margin: 0;
        background: #f3f3f3;
    }

    img {
        max-width: 90vw;
        max-height: 70vh;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.3);
        margin-bottom: 15px;
    }

    .controls {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
    }

    .btn {
        padding: 10px 20px;
        background: #333;
        color: white;
        border-radius: 6px;
        font-size: 18px;
        cursor: pointer;
        user-select: none;
        transition: 0.2s;
    }

    .btn:hover {
        background: #555;
    }

    .icon-btn {
        background: none;
        border: none;
        cursor: pointer;
        font-size: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s, color 0.3s;
        margin-right: 10px;
    }

    .like-btn.liked {
        color: red;
    }

    .share-btn.liked svg {
        color: #004080; /* dunkleres Blau */
    }

    .share-btn svg {
        width: 30px;
        height: 30px;
        color: #999;
        transition: color 0.3s;
    }

    /* Pop Animation */
    .pop {
        animation: popAnim 0.2s ease;
    }

    @keyframes popAnim {
        0% { transform: scale(1); }
        50% { transform: scale(1.4); }
        100% { transform: scale(1); }
    }
</style>
</head>
<body>

<h2>Bildergalerie</h2>

<img id="bild" src="" alt="Bild">

<div class="controls">
    <div class="btn" onclick="prevImage()">⬅ Zurück</div>
    <div class="btn" onclick="nextImage()">Weiter ➡</div>
</div>

<div style="display:flex; margin-top:10px;">
    <button id="likeBtn" class="icon-btn like-btn" onclick="toggleLike()">❤</button>
    <button id="shareBtn" class="icon-btn share-btn" onclick="toggleShare()">
        <svg viewBox="0 0 24 24" fill="currentColor">
            <path d="M2 4h20v16H2V4zm2 2v2l8 5 8-5V6H4zm0 4v8h16v-8l-8 5-8-5z"/>
        </svg>
    </button>
</div>

<script>
    const bilder = [
        "Katze.jpg",
        "Hund.jpg",
        "Maus.jpg",
        "Elefant.jpg",
        "Löwe.jpg",
        "Käfer.jpg",
        "Schildkröte.jpg",
        "Hase.jpg",
        "Nashorn.jpg",
        "Mücke.jpg"
    ];

    let index = 0;
    let startTime = Date.now();
    let zeiten = Array(bilder.length).fill(0);

    const bildElement = document.getElementById("bild");
    const likeBtn = document.getElementById("likeBtn");
    const shareBtn = document.getElementById("shareBtn");

    let liked = Array(bilder.length).fill(false);
    let shared = Array(bilder.length).fill(false);

    function updateImage(){
        bildElement.src = bilder[index];
        likeBtn.classList.toggle("liked", liked[index]);
        shareBtn.classList.toggle("liked", shared[index]);
    }

    function saveTime(){
        const endTime = Date.now();
        zeiten[index] += (endTime - startTime)/1000;
        startTime = Date.now();
    }

    function nextImage(){
        saveTime();
        if(index === bilder.length - 1){
            downloadCSV();
            index = 0;
        } else {
            index += 1;
        }
        updateImage();
    }

    function prevImage(){
        saveTime();
        index = (index -1 + bilder.length)%bilder.length;
        updateImage();
    }

    document.addEventListener("keydown", (e) => {
        if(e.key==="ArrowRight") nextImage();
        if(e.key==="ArrowLeft") prevImage();
    });

    function toggleLike(){
        liked[index] = !liked[index];
        likeBtn.classList.toggle("liked", liked[index]);
        animatePop(likeBtn);
    }

    function toggleShare(){
        shared[index] = !shared[index];
        shareBtn.classList.toggle("liked", shared[index]);
        animatePop(shareBtn);
    }

    function animatePop(element){
        element.classList.add("pop");
        setTimeout(()=>element.classList.remove("pop"), 200);
    }

    function downloadCSV(){
        saveTime();
        let csv = "data:text/csv;charset=utf-8,Bild,Zeit (Sekunden),Like,Geteilt\n";
        zeiten.forEach((t,i)=>{
            csv += `Bild ${i+1},${t.toFixed(2)},${liked[i] ? "Ja" : "Nein"},${shared[i] ? "Ja" : "Nein"}\n`;
        });
        const link = document.createElement("a");
        link.setAttribute("href", encodeURI(csv));
        link.setAttribute("download","bilderzeiten.csv");
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        zeiten = Array(bilder.length).fill(0);
        liked = Array(bilder.length).fill(false);
        shared = Array(bilder.length).fill(false);
        startTime = Date.now();
        updateImage();
        alert("Zeiten, Likes und Shares wurden gespeichert und zurückgesetzt!");
    }

    window.addEventListener("beforeunload", saveTime);
    updateImage();
</script>

</body>
</html>
